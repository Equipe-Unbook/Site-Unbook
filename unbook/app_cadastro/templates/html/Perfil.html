{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0c36a1">
    <link rel="shortcut icon" href="{% static 'image/UnBook_page.ico' %}" type="image/x-icon" />
    <title>Perfil</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.3/font/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="{% static 'css/styles_(Perfil.html).css' %}" />

  </head>

  <body>
    <div id="fundo_blur"></div>

    <div id="modal_certeza">
        <h2 id="title_c">Tem certeza que deseja apagar sua conta?</h2>
        
        <figure class="gif">
          <img id="dog" src="{% static "image/dog-sad.gif" %}">
        </figure>

        <div id="espace_buttons">
          <a type="button" class="button_c" id="sim_c" href="#" >Sim</a> 
          {% comment %} href="{% url 'excluir_usuario' username=user.username %}" {% endcomment %}
          <a type="button" class="button_c" id="nao_c" href="">Não</a>
        </div>
        
    </div>  


    <div id="modal_atualizacao">
      <div id="avaliacao">
        <h1 class="CampoFalado1_modal">Atualizar perfil</h1>
        <hr style="margin: 0 1em" />
        <div id="scroll_modal">
          <div id="boxes_modal">
            <div class="boxes_modal" id="box_modal_1">
              <h2 class="CampoFalado2_modal">Curso</h2>
              <h4 class="CampoFalado3_modal">Qual é o seu curso?</h4>
              <hr style="margin: 1em 5em" />
              
      <form id="form" action="./usuario/" method="post" name="contact-form">
                {% csrf_token %}
                <input type="text" autocomplete="off" id="input_cursos" onkeyup="cursos_find('{{ csrf_token }}')" />
        
                <ul id="cursos" style="display: none;"></ul>
            
              <div class="espaco_buttons">
                <h2 class="prox_button" id="prox_button_1">Próximo</h2>
              </div>
            </div>

            <div class="boxes_modal" id="box_modal_2">
              <h2 class="CampoFalado2_modal">Semestre</h2>
              <h4 class="CampoFalado3_modal">Em qual semestre você entrou na UnB?</h4>
              <hr style="margin: 1em 5em" />
              <div id="drop">
                <div class="drop_button">
                  <span id="CampoFalado_menu">Semestre</span>
                  <i id="icon_menu" class="bi bi-caret-down-fill"></i>
                </div>

                <ul class="menu">
                  <li class="menu_item" onclick="selecionado(this)">2024.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2023.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2023.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2022.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2022.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2021.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2021.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2020.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2020.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2019.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2019.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2018.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2018.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2017.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2017.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2016.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2016.1</li>
                  <li class="menu_item" onclick="selecionado(this)">2015.2</li>
                  <li class="menu_item" onclick="selecionado(this)">2015.1</li>
                </ul>
              </div>

              <div class="espaco_buttons">
                <h2 class="back_button" id="back_button_1">Voltar</h2>
                <h2 class="prox_button" id="prox_button_2">Próximo</h2>
              </div>
            </div>

            <div class="boxes_modal" id="box_modal_3">
              <h2 class="CampoFalado2_modal">Sobre você</h2>
              <h4 class="CampoFalado3_modal">Conte um pouco sobre você! Queremos te conhecer!</h4>
              <hr style="margin: 1em 5em" />
              <div>
                {% comment %} <textarea id="bio" rows="5" cols="33" oninput="bio(this)"></textarea> {% endcomment %}
                <input id="bio" type="text"></input>
              </div>

              <div class="espaco_buttons">
                <h2 class="back_button" id="back_button_2">Voltar</h2>
                <h2 class="prox_button" id="prox_button_3">Próximo</h2>
                {% comment %} nao precisa ser um input {% endcomment %}
              </div>
            </div>

            <div class="boxes_modal" id="box_modal_4">
              <h2 class="CampoFalado2_modal">Visibilidade do perfil</h2>
              <h4 class="CampoFalado3_modal">Deseja que seu perfil seja:</h4>
              <hr style="margin: 1em 5em" />
              
              <div id="privs_button">
                <div class="perfil_visivel" id="priv"  onclick="setVisibility(this , 0)" > Privado</div>
                <div class="perfil_visivel" id="public" onclick="setVisibility(this, 1)" > Público</div>
              </div>
              <input type="hidden" id="perfil_visibilidade" name="perfil_visibilidade">

              <div class="espaco_buttons">
                <h2 class="back_button" id="back_button_3">Voltar</h2>
                <h2 class="prox_button" id="prox_button_4">Enviar</h2>
                {% comment %} nao precisa ser um input {% endcomment %}
              </div>
            </div>


          </div>
        </div>
      </form>
      </div>
    </div>

    <a href="/"><img class="UnBook_logo_mini" src="{% static 'image/UnBook_loguinho.png' %}" alt="UnBook Logo" /></a>

    <div id="boxes">
      <div id="modal_imgs">
        <div class="imgs_modal">
          <img  onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="1" src="{% static "image/profiles/1.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="2" src="{% static "image/profiles/2.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="3" src="{% static "image/profiles/3.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="4" src="{% static "image/profiles/4.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="5" src="{% static "image/profiles/5.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="6" src="{% static "image/profiles/6.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="7" src="{% static "image/profiles/7.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="8" src="{% static "image/profiles/8.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="9" src="{% static "image/profiles/9.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="10" src="{% static "image/profiles/10.jpeg" %}"/>

        </div>
        
        <div class="imgs_modal">
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="11" src="{% static "image/profiles/11.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="12" src="{% static "image/profiles/12.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="13" src="{% static "image/profiles/13.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="14" src="{% static "image/profiles/14.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="15" src="{% static "image/profiles/15.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="16" src="{% static "image/profiles/16.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="17" src="{% static "image/profiles/17.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="18" src="{% static "image/profiles/18.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="19" src="{% static "image/profiles/19.jpeg" %}"/>
          <img onclick="escolha_img(this, '{{ csrf_token }}')" class="balls" id="20" src="{% static "image/profiles/20.jpeg" %}"/>
        </div>
      </div>

      <div id="box1">
        <div id="espace_img_user">
          <a href="../../" id="voltar">x</a>

          <div id="img_user">
            <i id="edit" class="bi bi-pencil-square"></i>
            
            {% if perfil.foto == 0 %}
                <img id="img_img" src="{% static 'image/profiles/10.jpeg' %}">
            {% else %}
                {% comment %} <h2>{{ perfil.foto }}</h2> {% endcomment %}
                <img id="img_img" src="{% static 'image/profiles/' %}{{ perfil.foto }}.jpeg">
            {% endif %}
        </div>


        </div>

        <div id="CampoEscrito_box1">

        
        <div id="visib_modal">
          {% if perfil.privacidade == 1 %}
            <h4> Seu perfil pode ser visto por outras pessoas!</h4>
          {% elif perfil.privacidade == 0 %}
              <h4> Seu perfil é privado!</h4>
            {% endif%}
        </div>

        {% if perfil.privacidade == 1 %}
          <i  id="lampinha" class="lampinha , bi bi-lightbulb-fill"></i>
        {% elif perfil.privacidade == 0 %}
          <i id="lampinha" class="lampinha , bi bi-lightbulb-off-fill"></i>
        {% endif%}

        {% if user.is_superuser %}
            <h1 style="color:gold; text-shadow: 0 0 1px gold;" id="user_box1">@{{ user.username }}</h1>
        {% else %}
          <h1 id="user_box1">@{{ user.username }}</h1>
        {% endif %}

          <h2 class="CampoEscrito2_box1">{{ user.email }}</h2>
        </div>

        <hr style="margin: 0 2em" />

        <div id="scroll">
          <h2 class="pages" onclick="abrir_modal(this.id)" id="edit_profile">Perfil</h2>
          <h2 class="pages" onclick="abrir_modal(this.id)" id="edit_Config">Configurações</h2>
          <h2 class="pages" onclick="abrir_modal(this.id)" id="estatistica">Estatística</h2>
        </div>
      </div>

      <div id="espace_pages">
        <div class="boxs" id="Profile">
          {% csrf_token %}
          <div id="espace_1">
            <h1 class="CampoEscrito_profile">
              Seja bem-vindo <br />

              {% if user.is_superuser %}
              <span style="color:gold; text-shadow: 0 0 1px gold;" id="user">{{ user.first_name }}</span>
              {% comment %} <i style="color:gold; text-shadow: 0 0 2px gold;" class="fas fa-crown"></i> {% endcomment %}
              {% else %}
              <span id="user">{{ user.first_name }}</span>
              {% endif %}
              
            </h1>
          </div>
          <hr style="margin: 0 2em" />
          <div id="space_2_1_Profile">
            
            {%if perfil.curso == None %}
              <h2 class="CampoFalado_Profile">Curso: <span style="font-size:1em; color:grey" class="respostas">Atualize seu curso</span></h2>
            {% else %}
              <h2 class="CampoFalado_Profile">Curso: <span class="respostas">{{ perfil.curso }}</span></h2>
            {% endif %}

            {%if perfil.semestre == None %}
              <h2 class="CampoFalado_Profile">Semestre: <span style="font-size:1em ; color:grey" class="respostas">Atualize seu semestre</span></h2>
            {%else%}
              <h2 class="CampoFalado_Profile">Semestre: <span class="respostas">{{ perfil.semestre }}</span></h2>
            {% endif %}
            
            
          </div>
          <hr style="margin: 0 5em" />
          <div id="space_2_2_Profile">
            <h2 class="CampoFalado_Profile">Sobre você:</h2>
            {%if perfil.descricao == None %}
              <h2 style="font-size:1em ; color:grey" class="respostas2">Atualize sua descrição</h2>
            {%else%}
              <h2 class="respostas2">{{ perfil.descricao }}</h2>
            {% endif %}
              
          </div>
          <div id="space_2_3_Profile">
            <h2 class="botoes" id="atualizar">Atualizar informações</h2>
            {% if user.is_authenticated %}
              <a class="botoes" id="Logout" type="button" href="{% url 'logout' %}">Logout</a>
              <a class="botoes" id="Deletar" type="button" onclick="certeza()">Excluir Usuário</a>
            {% endif %}
          </div>
        </div>

        <div class="boxs" id="Config">
          {% csrf_token %}
          <div id="space_1_Config">
            <h1 class="CampoEscrito_Config">Configurações</h1>
          </div>
          <hr style="margin: 0 2em" />
          
          <div id="separa_confs">

            <div id="space_2_1_Config">
                <h1 class="alterar"> Alterar Senha </h1>  
                <hr style="margin: 0.5em 1em 0.5em 0" />

                <form id="mudar_senha_form">
                  {% csrf_token %}
                    <h2 class="CampoFalado_Config">Senha antiga</h2>
                    <input class="forms" type="password" id="senha_antiga" name="senha_antiga" required />

                    <h2 class="CampoFalado_Config">Senha Nova</h2>
                    <input class="forms" type="password" id="senha_nova" name="senha_nova" required />

                    <h2 class="CampoFalado_Config">Confirmar senha nova</h2>
                    <input class="forms" type="password" id="senha_nova_confirma" name="senha_nova_confirma" required />

                    <button id="submit1" type="submit">Mudar senha</button>
                </form>
                
                  {% if messages %}
                      <ul>
                        {% for message in messages %}
                          <li>{{ message }}</li>
                        {% endfor %}
                      </ul>
                  {% endif %}
            </div>

            <div id="space_2_2_Config">

              <h1  class="alterar"> Alterar Username </h1> 
              <hr style="margin: 0.5em 1em 0.5em 0" />

              <form id="usernameForm" >  
                {% csrf_token %}
                  <h2 class="CampoFalado_Config">Mudar Username</h2>
                  <input class="forms" type="text" id="username" required />
                  
                  <button id="submit2" type="submit">Mudar Username</button>
              </form>
              
                {% if messages %}
                    <ul>
                      {% for message in messages %}
                        <li>{{ message }}</li>
                      {% endfor %}
                    </ul>
                {% endif %}
          </div>




          </div>

        </div>

        <div class="boxs" id="Estatistica">
          {% csrf_token %}
          <div id="box_desenv">
            <h1 id="Desenv">Em desenvolvimento!</h1>
          </div>
        </div>
      </div>
    </div>

    <script src="{% static 'js/script_(Perfil.html).js' %}"></script>
    
    <script>
      document.getElementById('prox_button_4').addEventListener('click', (e)=> {
          e.preventDefault();
          const curso = document.getElementById('input_cursos').value;
          const semestre = document.getElementById('CampoFalado_menu').innerText;
          const bio = document.getElementById('bio').value;
          const visibilidade = document.getElementById('priv').value
          
          enviarDados(curso, semestre, bio, visibilidade);
      });
    </script>
    {% if messages %}
        <ul>
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
  </body>
</html>
